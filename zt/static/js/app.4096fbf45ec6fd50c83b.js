webpackJsonp([1],{0:function(e,t,a){a("briU"),e.exports=a("NHnr")},"4Nbu":function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("xd7I"),l=a("2bvH"),o=a("H3vm");s.default.use(l.a);var r=new o.a({storage:window.localStorage}),n=new l.a.Store({state:{useName:"liubai",userInfo:null,pathName:null,curContractNo:"",resultDataOrigin:[]},actions:{updateContractNo:function(e,t){var a=e.commit;e.state,a("setCurContractNo",t)},updateResultData:function(e,t){var a=e.commit;e.state,a("setResultData",t)},updateUserInfo:function(e,t){var a=e.commit;e.state,a("setUserInfo",t)},changePath:function(e,t){var a=e.commit;e.state,a("setPath",t)}},mutations:{setCurContractNo:function(e,t){e.curContractNo=t},setResultData:function(e,t){e.resultDataOrigin=t},setUserInfo:function(e,t){e.userInfo=t},setPath:function(e,t){e.pathName=t}},plugins:[r.plugin]}),i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var c=a("C7Lr")({name:"App"},i,!1,function(e){a("alRU")},null,null).exports,m=a("3XdE"),p=a("rVsN"),u=a.n(p),f=a("lC5x"),d=a.n(f),g=a("J0Oq"),v=a.n(g),h=a("3cXf"),b=a.n(h),_=a("4YfN"),x=a.n(_),w=a("qqHy"),y=a.n(w),C={name:"ProcessEdit",props:["processName","curEditIdx","curLuiChengIdx","contractNo","curTimeStamp","processStatus"],data:function(){return{dialogProcessVisible:!0,fileUrl:"",formFile:{fileName:"",percent:"",jgDate:"",sjPrice:""},rulesFile:{fileName:[{required:!0,message:"请选择需要上传的文件!",trigger:"change"}],percent:[{required:!0,message:"请输入完成比例!",trigger:"change"}]},fileList:[],ifShowUpload:!1,liuCheng:["放号","合同签订","进场施工","设备到现场","隐蔽验收","安装调试","竣工验收","审价结算","项目移交","质保开始","质保结束"]}},computed:{uploadAdr:function(){return"http://192.168.1.13:8081/fushengJK/uploadFileZT?mulu="+this.contractNo}},watch:{curTimeStamp:{handler:function(e){this.getFileList()},deep:!0,immediate:!0}},methods:{closeDialog:function(){this.$emit("toggleProcessDialog",!1)},handleUploadSuccess:function(e){this.formFile.fileName=e.filename,this.submit(e.filename)},removeFile:function(e,t){this.formFile.fileName=""},changeFile:function(e){this.formFile.fileName=e.name},deleteFile:function(e){var t=this,a='<?xml version="1.0" encoding="utf-8"?>';a+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',a+="<soap:Body> ",a+='<PIC_UPLoad_DEL xmlns="http://tempuri.org/">',a+="<FContractNo>"+this.contractNo+"</FContractNo>",a+="<FType>"+this.processName+"</FType>",a+="<FPath>"+e.fileName+"</FPath>",a+="</PIC_UPLoad_DEL>",a+="</soap:Body>",a+="</soap:Envelope>",this.Http.post("PIC_UPLoad_DEL",a).then(function(e){var a=e.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("PIC_UPLoad_DELResponse")[0].getElementsByTagName("PIC_UPLoad_DELResult")[0],l=y()(s).html();"1"===JSON.parse(l)[0].code?(t.$message({message:"删除成功!",type:"success"}),t.getFileList()):t.$message({message:"删除失败!",type:"error"})}).catch(function(e){console.log(e)})},uploadFile:function(e){var t=this;this.$refs[e].validate(function(e){e?t.$refs.upload.submit():t.$message({message:"请将信息补充完整！",type:"warning"})})},submit:function(e){var t=this,a="设备到现场"===this.processName||"隐蔽验收"===this.processName||"安装调试"===this.processName?this.formFile.percent:0,s='<?xml version="1.0" encoding="utf-8"?>';s+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',s+="<soap:Body> ",s+='<PIC_UPLoad xmlns="http://tempuri.org/">',s+="<FContractNo>"+this.contractNo+"</FContractNo>",s+="<FType>"+this.processName+"</FType>",s+="<FPath>"+e+"</FPath>",s+="<FPercent>"+a+"</FPercent>",s+="</PIC_UPLoad>",s+="</soap:Body>",s+="</soap:Envelope>",this.Http.post("PIC_UPLoad",s).then(function(e){var a=e.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("PIC_UPLoadResponse")[0].getElementsByTagName("PIC_UPLoadResult")[0],l=y()(s).html();"1"===JSON.parse(l)[0].code?(t.$message({message:"上传成功!",type:"success"}),t.$emit("toggleProcessDialog",!1),t.$emit("refresh")):t.$message({message:"上传失败!",type:"error"})}).catch(function(e){console.log(e)})},getFileList:function(){var e=this,t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<JA_LIST xmlns="http://tempuri.org/">',t+="<FSQL>select fcontractno 合同号,ftype 阶段,'http://plant.fs-elliott.cn:8082/zetian_file/'+fcontractno+'/'+fpath 文件路径,convert(varchar(50),fdate,23)fdate,isnull(fper,0)fper from Z_FILE where fcontractno='"+this.contractNo+"' and ftype='"+this.processName+"'</FSQL>",t+="</JA_LIST>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("JA_LIST",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("JA_LISTResponse")[0].getElementsByTagName("JA_LISTResult")[0],l=y()(s).html(),o=JSON.parse(l);e.fileList=o.map(function(t){t.fileDate=t.fdate?t.fdate:"",t.fpercent=t.fper+"%",t.fileUrl=t["文件路径"];var a=t["文件路径"].indexOf(e.contractNo)+e.contractNo.length+1;return t.fileName=t["文件路径"].slice(a),t}),console.log(e.fileList),"隐蔽验收"===e.processName||"安装调试"===e.processName?e.ifShowUpload=!0:e.ifShowUpload=0===o.length}).catch(function(e){console.log(e)})},saveJgDate:function(){var e=this;if(!this.formFile.jgDate)return this.$message({message:"请选择竣工日期!",type:"warning"}),!1;var t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<Jungong_Date xmlns="http://tempuri.org/">',t+="<FContractNo>"+this.contractNo+"</FContractNo>",t+="<FDate>"+this.formFile.jgDate+"</FDate>",t+="</Jungong_Date>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("Jungong_Date",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("Jungong_DateResponse")[0].getElementsByTagName("Jungong_DateResult")[0],l=y()(s).html();"1"===JSON.parse(l)[0].code?e.surefinish():e.$message({message:"竣工日期保存失败!",type:"error"})}).catch(function(e){console.log(e)})},saveSjPrice:function(){var e=this;if(!this.formFile.sjPrice)return this.$message({message:"请输入审价金额!",type:"warning"}),!1;var t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<ShenJi_Amount xmlns="http://tempuri.org/">',t+="<FContractNo>"+this.contractNo+"</FContractNo>",t+="<FAmount>"+this.formFile.sjPrice+"</FAmount>",t+="</ShenJi_Amount>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("ShenJi_Amount",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("ShenJi_AmountResponse")[0].getElementsByTagName("ShenJi_AmountResult")[0],l=y()(s).html();"1"===JSON.parse(l)[0].code?e.surefinish():e.$message({message:"审价金额保存失败!",type:"error"})}).catch(function(e){console.log(e)})},finish:function(){switch(this.processName){case"竣工验收":this.saveJgDate();break;case"审价结算":this.saveSjPrice();break;default:this.surefinish()}},surefinish:function(){var e=this,t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<jindu xmlns="http://tempuri.org/">',t+="<FContractNo>"+this.contractNo+"</FContractNo>",t+="<FType>"+this.processName+"</FType>",t+="<FColor>2</FColor>",t+="</jindu>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("jindu",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("jinduResponse")[0].getElementsByTagName("jinduResult")[0],l=y()(s).html();"1"===JSON.parse(l)[0].code?(e.$message({message:"确认成功!",type:"success"}),e.$emit("toggleProcessDialog",!1),e.$emit("markRed",e.curEditIdx)):e.$message({message:"确认失败!",type:"error"})}).catch(function(e){console.log(e)})},backUnFinished:function(){var e=this,t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<jindu xmlns="http://tempuri.org/">',t+="<FContractNo>"+this.contractNo+"</FContractNo>",t+="<FType>"+this.processName+"</FType>",t+="<FColor>"+(this.curLuiChengIdx>this.curEditIdx?3:1)+"</FColor>",t+="</jindu>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("jindu",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("jinduResponse")[0].getElementsByTagName("jinduResult")[0],l=y()(s).html();"1"===JSON.parse(l)[0].code?(e.$message({message:"反确认成功!",type:"success"}),e.$emit("toggleProcessDialog",!1),e.$emit("refresh")):e.$message({message:"反确认失败!",type:"error"})}).catch(function(e){console.log(e)})},beforeUpload:function(e){},buf2hex:function(e){return Array.prototype.map.call(new Uint8Array(e),function(e){return("00"+e.toString(16)).slice(-2)}).join("")}}},F={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ProcessEdit"},[a("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.processName,visible:e.dialogProcessVisible,width:"650px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogProcessVisible=t}}},[a("section",["放号"!=e.processName?a("p",{staticClass:"TextAlignL MarginB_10"},[a("b",[e._v("已上传的文件：")])]):e._e(),e._v(" "),"放号"!=e.processName&&0==e.fileList.length?a("p",{staticClass:"TextAlignL PaddingL_28"},[e._v("无相关文件")]):e._e(),e._v(" "),e.fileList.length>0?a("div",e._l(e.fileList,function(t,s){return a("p",{key:s,staticClass:"TextAlignL MarginB_10 PaddingL_28"},[e._v("\n          "+e._s(s+1)+".  "),a("a",{attrs:{href:t.fileUrl}},[e._v(e._s(t.fileName))]),e._v(" "),"设备到现场"==e.processName||"隐蔽验收"==e.processName||"安装调试"==e.processName?a("span",{staticStyle:{float:"right",width:"50px","text-align":"right"}},[e._v(e._s(t.fpercent))]):e._e(),e._v(" "),a("span",{staticStyle:{float:"right"}},[e._v("\n            "+e._s(t.fileDate)+"\n            "),a("i",{staticClass:"el-icon-delete CursorPointer",staticStyle:{"margin-left":"20px"},on:{click:function(a){return e.deleteFile(t)}}})])])}),0):e._e(),e._v(" "),"放号"!=e.processName&&2!=e.processStatus?a("div",[a("p",{staticClass:"TextAlignL MarginT_20"},[a("b",[e._v("上传新文件："+e._s(e.formFile.fileName))])]),e._v(" "),a("el-form",{ref:"formFile",attrs:{model:e.formFile,rules:e.rulesFile,"label-width":"100px","label-position":"left"}},[a("el-form-item",{staticClass:"TextAlignL",attrs:{label:"文件",prop:"fileName"}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.uploadAdr,accept:".pdf,.doc,.PDF",limit:1,"on-change":e.changeFile,"before-upload":e.beforeUpload,"on-remove":e.removeFile,"on-success":e.handleUploadSuccess,"auto-upload":!1},model:{value:e.formFile.fileName,callback:function(t){e.$set(e.formFile,"fileName",t)},expression:"formFile.fileName"}},[a("el-button",{attrs:{slot:"trigger",size:"small",icon:"el-icon-upload",type:""},slot:"trigger"},[e._v("请选取上传的文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",staticStyle:{display:"inline-block","padding-left":"10px","margin-top":"0"},attrs:{slot:"tip"},slot:"tip"},[e._v("（ 文件格式需为doc/pdf ）")])],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[2!=e.processStatus&&"放号"!=e.processName?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.uploadFile("formFile")}}},[e._v("提 交")]):e._e()],1)],1)],1),e._v(" "),"设备到现场"==e.processName||"隐蔽验收"==e.processName||"安装调试"==e.processName?a("el-form-item",{staticClass:"TextAlignL",attrs:{label:"完成比列",prop:"percent"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.formFile.percent,callback:function(t){e.$set(e.formFile,"percent",t)},expression:"formFile.percent"}},[a("el-button",{attrs:{slot:"append"},slot:"append"},[e._v("%")])],1)],1):e._e(),e._v(" "),"竣工验收"==e.processName?a("el-form-item",{staticClass:"TextAlignL",attrs:{label:"竣工日期",prop:"jgDate"}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.formFile.jgDate,callback:function(t){e.$set(e.formFile,"jgDate",t)},expression:"formFile.jgDate"}})],1)],1)],1):e._e(),e._v(" "),"审价结算"==e.processName?a("el-form-item",{staticClass:"TextAlignL",attrs:{label:"审价金额",prop:"sjPrice"}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.formFile.sjPrice,callback:function(t){e.$set(e.formFile,"sjPrice",t)},expression:"formFile.sjPrice"}})],1)],1)],1):e._e()],1)],1):e._e()]),e._v(" "),a("span",{staticClass:"dialog-footer TextAlignC",staticStyle:{width:"100%",display:"inline-block"},attrs:{slot:"footer"},slot:"footer"},[2!=e.processStatus?a("el-button",{attrs:{type:"danger"},on:{click:e.finish}},[e._v("确认完成")]):e._e(),e._v(" "),2==e.processStatus?a("el-button",{attrs:{type:"danger"},on:{click:e.backUnFinished}},[e._v("反确认")]):e._e()],1)])],1)},staticRenderFns:[]};var S={name:"InfoDynamicTable",data:function(){return{ifEdit:!1,processName:"",curLuiCheng:"",curLuiChengIdx:"",curEditIdx:"",processStatus:"",formBasic:{},xmjlHistory:[],swryHistory:[],receiptRateInfo:[],warnList:["预收款未收齐"],steps:[],curTimeStamp:"",liuCheng:["放号","合同签订","进场施工","设备到现场","隐蔽验收","安装调试","竣工验收","审价结算","项目移交","质保开始","质保结束"]}},components:{ProcessEdit:a("C7Lr")(C,F,!1,function(e){a("akVs")},"data-v-87a0c9ca",null).exports},computed:x()({},Object(l.c)({curContractNo:function(e){return e.curContractNo},userInfo:function(e){return e.userInfo}})),created:function(){this.getInfor(),this.getxmjl(),this.getSwry()},methods:{toggleProcessDialog:function(e){this.ifEdit=e},save:function(){var e=this,t={items:[{FContractNo:this.curContractNo,f1:this.formBasic.swry,f2:this.formBasic.xmjl,fsdate:this.formBasic.kgrq?this.formBasic.kgrq:"",fedate:this.formBasic.wgrq?this.formBasic.wgrq:""}]},a='<?xml version="1.0" encoding="utf-8"?>';a+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',a+="<soap:Body> ",a+='<Contractdetail xmlns="http://tempuri.org/">',a+="<FJSONMSG>"+b()(t)+"</FJSONMSG>",a+="</Contractdetail>",a+="</soap:Body>",a+="</soap:Envelope>",this.Http.post("Contractdetail",a).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("ContractdetailResponse")[0].getElementsByTagName("ContractdetailResult")[0],l=y()(s).html();"1"===JSON.parse(l)[0].code?(e.$message({message:"保存成功!",type:"success"}),e.getInfor(),e.getxmjl(),e.getSwry()):e.$message({message:"保存失败!",type:"error"})}).catch(function(e){console.log(e)})},changeStep:function(e){switch(this.processStatus=this.steps[e].status,this.curTimeStamp=(new Date).getTime(),this.processName=this.steps[e].tit,this.steps[e].status){case 0:this.$message({message:"该流程不可进行编辑！",type:"warning"});break;default:this.steps[e].author?(this.curEditIdx=e,this.toggleProcessDialog(!0)):this.$message({message:"对不起，您没有权限对此流程进行编辑！",type:"warning"})}},getInfor:function(){var e=this;return v()(d.a.mark(function t(){var a,s;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getReceiptRate();case 2:return a=t.sent,t.next=5,e.getAuthor();case 5:s=t.sent,e.getBasicInfor(a,s);case 7:case"end":return t.stop()}},t,e)}))()},getBasicInfor:function(e,t){var a=this,s='<?xml version="1.0" encoding="utf-8"?>';s+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',s+="<soap:Body> ",s+='<JA_LIST xmlns="http://tempuri.org/">',s+="<FSQL>SELECT * FROM Z_Contract WHERE  合同号='"+this.curContractNo+"'</FSQL>",s+="</JA_LIST>",s+="</soap:Body>",s+="</soap:Envelope>",this.Http.post("JA_LIST",s).then(function(s){var l=s.data,o=(new DOMParser).parseFromString(l,"text/xml").getElementsByTagName("JA_LISTResponse")[0].getElementsByTagName("JA_LISTResult")[0],r=y()(o).html(),n=JSON.parse(r)[0];a.formBasic={contractNo:n["合同号"],projectName:n["项目名称"],signDepartment:n["部门"],customerName:n["客户"],swry:n["商务人员"],qyrq:n["签约日期"],htje:n["合同金额"],ysmll:"",xmjl:n["项目经理"],kgrq:n["开工日期"]?n["开工日期"].slice(0,10):"",wgrq:n["完工日期"]?n["完工日期"].slice(0,10):"",jsj:n["结算价"],sjj:n["审计价"],ljkp:n["累计开票"],ljsk:n["累计收款"],chl:n["出货率"],skl:n["收款率"],jgrq:n["竣工日期"],zbq:n["质保期"],zbks:n["质保起"],zbjs:n["质保至"]},a.steps=[{status:n["放号"],date:"",tit:"放号",author:t["放号"]},{status:n["合同签订"],date:"",tit:"合同签订",author:t["合同签订"]},{status:n["进场施工"],date:"",tit:"进场施工",author:t["进场施工"]},{status:n["设备到现场"],date:"",tit:"设备到现场",author:t["设备到现场"]},{status:n["隐蔽验收"],date:"",tit:"隐蔽验收",author:t["隐蔽验收"]},{status:n["安装调试"],date:"",tit:"安装调试",author:t["安装调试"]},{status:n["竣工验收"],date:"",tit:"竣工验收",author:t["竣工验收"]},{status:n["审价结算"],date:"",tit:"审价结算",author:t["审价结算"]},{status:n["项目移交"],date:"",tit:"项目移交",author:t["项目移交"]},{status:n["质保开始"],date:"",tit:"质保开始",author:t["质保开始"]},{status:n["质保结束"],date:"",tit:"质保结束",author:t["质保结束"]}];for(var i=0;i<11;i++)if(1===n[a.liuCheng[i]]){a.curLuiCheng="放号"===a.liuCheng[i]?"--":a.liuCheng[i],a.curLuiChengIdx=i;break}a.receiptRateInfo=e.map(function(e){var t=e.fpercent.substr(0,e.fpercent.length-1)/100;return e.ys=a.formBasic.htje*t,e.sj=a.formBasic.ljsk*t,e.ws=e.ys-e.sj,e})}).catch(function(e){console.log(e)})},getSwry:function(){var e=this,t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<JA_LIST xmlns="http://tempuri.org/">',t+="<FSQL><![CDATA[select f1 商务人员 from Z_Contract_log where isnull(f1,'')<>'' and FContractNo='"+this.curContractNo+"'  order by fid]]></FSQL>",t+="</JA_LIST>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("JA_LIST",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("JA_LISTResponse")[0].getElementsByTagName("JA_LISTResult")[0],l=y()(s).html(),o=JSON.parse(l);e.swryHistory=o}).catch(function(e){console.log(e)})},getxmjl:function(){var e=this,t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<JA_LIST xmlns="http://tempuri.org/">',t+="<FSQL><![CDATA[select f2 项目经理 from Z_Contract_log where isnull(f2,'')<>'' and FContractNo='"+this.curContractNo+"' order by fid]]></FSQL>",t+="</JA_LIST>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("JA_LIST",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("JA_LISTResponse")[0].getElementsByTagName("JA_LISTResult")[0],l=y()(s).html(),o=JSON.parse(l);e.xmjlHistory=o}).catch(function(e){console.log(e)})},getReceiptRate:function(){var e=this;return new u.a(function(t,a){var s='<?xml version="1.0" encoding="utf-8"?>';s+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',s+="<soap:Body> ",s+='<JA_LIST xmlns="http://tempuri.org/">',s+="<FSQL>select c.FName,(convert(varchar(50),b.FInteger)+'%')fpercent from t_RPContract a inner join skbl b on a.FContractID=b.FContractID inner join (select FInterID,FName from t_SubMessage where FTypeID=10001) c on c.FInterID=b.FBase1 where a.FContractNo='"+e.curContractNo+"'</FSQL>",s+="</JA_LIST>",s+="</soap:Body>",s+="</soap:Envelope>",e.Http.post("JA_LIST",s).then(function(e){var a=e.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("JA_LISTResponse")[0].getElementsByTagName("JA_LISTResult")[0],l=y()(s).html(),o=JSON.parse(l);t(o)}).catch(function(e){console.log(e)})})},getAuthor:function(){var e=this;return new u.a(function(t,a){var s='<?xml version="1.0" encoding="utf-8"?>';s+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',s+="<soap:Body> ",s+='<JA_LIST xmlns="http://tempuri.org/">',s+="<FSQL>select isnull(f_102,0)放号,isnull(f_103,0)合同签订,isnull(f_104,0)进场施工,isnull(f_105,0)设备到现场,isnull(f_106,0)隐蔽验收,isnull(f_107,0)安装调试,isnull(f_108,0)竣工验收,isnull(f_109,0)审价结算,isnull(f_110,0)项目移交,isnull(f_111,0)质保开始,isnull(f_112,0)质保结束 from t_emp where fitemid="+e.userInfo.fempid+"</FSQL>",s+="</JA_LIST>",s+="</soap:Body>",s+="</soap:Envelope>",e.Http.post("JA_LIST",s).then(function(e){var a=e.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("JA_LISTResponse")[0].getElementsByTagName("JA_LISTResult")[0],l=y()(s).html(),o=JSON.parse(l)[0];t(o)}).catch(function(e){console.log(e)})})},markRed:function(e){var t=this;this.steps.map(function(a,s){if(1===a.status&&s<e){var l='<?xml version="1.0" encoding="utf-8"?>';l+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',l+="<soap:Body> ",l+='<jindu xmlns="http://tempuri.org/">',l+="<FContractNo>"+t.curContractNo+"</FContractNo>",l+="<FType>"+a.tit+"</FType>",l+="<FColor>3</FColor>",l+="</jindu>",l+="</soap:Body>",l+="</soap:Envelope>",t.Http.post("jindu",l).then(function(e){}).catch(function(e){console.log(e)})}10===s&&t.getInfor()})}}},L={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"InfoDynamicTable"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"ModuleTit TextAlignL"},[e._v("项目信息")]),e._v(" "),a("el-form",{ref:"formBasic",staticClass:"DisabledNormal MarginT_20",staticStyle:{"padding-right":"20px"},attrs:{model:e.formBasic,"label-width":"90px",size:"small"}},[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"合同编号"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.contractNo,callback:function(t){e.$set(e.formBasic,"contractNo",t)},expression:"formBasic.contractNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-form-item",{attrs:{label:"项目名称"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.projectName,callback:function(t){e.$set(e.formBasic,"projectName",t)},expression:"formBasic.projectName"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"签约部门"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.signDepartment,callback:function(t){e.$set(e.formBasic,"signDepartment",t)},expression:"formBasic.signDepartment"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户名称"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.customerName,callback:function(t){e.$set(e.formBasic,"customerName",t)},expression:"formBasic.customerName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"签约日期"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.qyrq,callback:function(t){e.$set(e.formBasic,"qyrq",t)},expression:"formBasic.qyrq"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{staticClass:"TextAlignL",attrs:{span:6}},[a("el-form-item",{attrs:{label:"商务人员"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{clearable:""},model:{value:e.formBasic.swry,callback:function(t){e.$set(e.formBasic,"swry",t)},expression:"formBasic.swry"}}),e._v(" "),a("el-popover",{attrs:{placement:"right",width:"100",trigger:"click"}},[a("div",e._l(e.swryHistory,function(t,s){return a("p",{key:s},[e._v(e._s(t["商务人员"]))])}),0),e._v(" "),a("el-button",{staticStyle:{width:"25%",display:"inline-block"},attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("历史记录")])],1)],1)],1),e._v(" "),a("el-col",{staticClass:"TextAlignL",attrs:{span:6}},[a("el-form-item",{attrs:{label:"项目经理"}},[a("el-input",{staticStyle:{width:"70%"},attrs:{clearable:""},model:{value:e.formBasic.xmjl,callback:function(t){e.$set(e.formBasic,"xmjl",t)},expression:"formBasic.xmjl"}}),e._v(" "),a("el-popover",{attrs:{placement:"right",width:"100",trigger:"click"}},[a("div",e._l(e.xmjlHistory,function(t,s){return a("p",{key:s},[e._v(e._s(t["项目经理"]))])}),0),e._v(" "),a("el-button",{staticStyle:{width:"25%",display:"inline-block"},attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("历史记录")])],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"合同金额"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.htje,callback:function(t){e.$set(e.formBasic,"htje",t)},expression:"formBasic.htje"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"预算毛利率"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.ysmll,callback:function(t){e.$set(e.formBasic,"ysmll",t)},expression:"formBasic.ysmll"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"开工日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.formBasic.kgrq,callback:function(t){e.$set(e.formBasic,"kgrq",t)},expression:"formBasic.kgrq"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"完工日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.formBasic.wgrq,callback:function(t){e.$set(e.formBasic,"wgrq",t)},expression:"formBasic.wgrq"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"结算价"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.jsj,callback:function(t){e.$set(e.formBasic,"jsj",t)},expression:"formBasic.jsj"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"审计价"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.sjj,callback:function(t){e.$set(e.formBasic,"sjj",t)},expression:"formBasic.sjj"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"累计开票"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.ljkp,callback:function(t){e.$set(e.formBasic,"ljkp",t)},expression:"formBasic.ljkp"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"累计收款"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.ljsk,callback:function(t){e.$set(e.formBasic,"ljsk",t)},expression:"formBasic.ljsk"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"出货率"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.chl,callback:function(t){e.$set(e.formBasic,"chl",t)},expression:"formBasic.chl"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"收款率"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.skl,callback:function(t){e.$set(e.formBasic,"skl",t)},expression:"formBasic.skl"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"竣工日期"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.jgrq,callback:function(t){e.$set(e.formBasic,"jgrq",t)},expression:"formBasic.jgrq"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"质保期"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.zbq,callback:function(t){e.$set(e.formBasic,"zbq",t)},expression:"formBasic.zbq"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"质保起"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.zbks,callback:function(t){e.$set(e.formBasic,"zbks",t)},expression:"formBasic.zbks"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"质保至"}},[a("el-input",{attrs:{disabled:""},model:{value:e.formBasic.zbjs,callback:function(t){e.$set(e.formBasic,"zbjs",t)},expression:"formBasic.zbjs"}})],1)],1)],1),e._v(" "),a("el-button",{staticClass:"MarginB_20",attrs:{type:"danger"},on:{click:e.save}},[e._v("保 存")])],1)],1),e._v(" "),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"ModuleTit TextAlignL"},[e._v("收款比例")]),e._v(" "),e.receiptRateInfo.length>0?a("section",{staticClass:"TextAlignL MarginB_10",staticStyle:{"font-size":"14px",height:"150px","overflow-y":"scroll",padding:"0 5px 5px 20px"}},[a("el-row",{staticStyle:{"margin-bottom":"10px","font-weight":"bold"}},[a("el-col",{attrs:{span:4}},[e._v("项目")]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v("实际比例")]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v("应收金额")]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v("实际金额")]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v("未收金额")])],1),e._v(" "),e._l(e.receiptRateInfo,function(t,s){return a("div",{key:s,staticClass:"text item MarginB_10"},[a("el-row",[a("el-col",{attrs:{span:4}},[e._v(e._s(s+1)+". "+e._s(t.FName))]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v(e._s(t.fpercent))]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v(e._s(t.ys))]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v(e._s(t.sj))]),e._v(" "),a("el-col",{attrs:{span:4}},[e._v(e._s(t.ws))])],1)],1)})],2):a("section",{staticClass:"TextAlignL MarginB_10",staticStyle:{"font-size":"14px",height:"100px"}},[a("div",{staticStyle:{"text-align":"center","line-height":"100px"}},[e._v("暂无数据")])])])],1),e._v(" "),a("el-col",{staticClass:"TextAlignL",attrs:{span:24}},[a("span",{staticClass:"ModuleTit"},[e._v("工程项目总进度")])]),e._v(" "),a("el-col",{staticClass:"StepWrap TextAlignL",staticStyle:{width:"100%","overflow-x":"scroll"},attrs:{span:24}},e._l(e.steps,function(t,s){return a("div",{key:s,class:{SetpItem:!0,NotAllowed:0==t.status},on:{click:function(t){return e.changeStep(s)}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:s>0,expression:"idx > 0"}],class:{LineItem:!0,bgGrey:0==t.status,bgYellow:1==t.status&&e.curLuiCheng!=t.tit,bgBlue:1==t.status&&e.curLuiCheng==t.tit,bgGreen:2==t.status,bgRed:3==t.status}}),e._v(" "),a("div",{staticClass:"DotItemwrap"},[a("div",{staticClass:"TextItem"},[a("p",[e._v(e._s("合同签订"==t.tit||"设备到现场"==t.tit?e.formBasic.swry:e.formBasic.xmjl))])]),e._v(" "),a("div",{class:{DotItem:!0,bgGrey:0==t.status,bgYellow:1==t.status&&e.curLuiCheng!=t.tit,bgBlue:1==t.status&&e.curLuiCheng==t.tit,bgGreen:2==t.status,bgRed:3==t.status}}),e._v(" "),a("div",{staticClass:"TextItem"},[a("p",[e._v(e._s(t.tit)+e._s(t.author))])])])])}),0),e._v(" "),e.ifEdit?a("ProcessEdit",{attrs:{curTimeStamp:e.curTimeStamp,processStatus:e.processStatus,processName:e.processName,curEditIdx:e.curEditIdx,curLuiChengIdx:e.curLuiChengIdx,contractNo:e.formBasic.contractNo},on:{markRed:e.markRed,refresh:e.getInfor,toggleProcessDialog:e.toggleProcessDialog}}):e._e()],1)},staticRenderFns:[]};var N=a("C7Lr")(S,L,!1,function(e){a("nUBg")},"data-v-00a92557",null).exports,B={name:"FilterTable",data:function(){return{loading:!1,tableHieght:0,formFilter:{signDepartment:-1,contractPrice:-1,signYear:-1,warnTip:-1,signAndFinish:-1,fileConditionn:-1,classCondition:-1,receivablesContion:-1,performBond:-1,qualityBond:-1,shipmentRate:"",receivablesRate:"",inQuality:-1,subItems:-1,sort:"",vagueSearch:""},resultData:[],signDepartmentList:[{label:"全部",value:-1},{label:"系统集成部",value:0},{label:"济南分公司",value:1},{label:"北京分公司",value:2},{label:"昆明分公司",value:3},{label:"武汉分公司",value:4},{label:"合肥分公司",value:5}],contractPriceList:[{label:"全部",value:-1},{label:"99万元以下",value:0},{label:"100-999万元",value:1},{label:"1000-2999万元",value:2},{label:"3000万元以上",value:3}],signYearList:[{label:"全部",value:-1},{label:"2015",value:0},{label:"2016",value:1},{label:"2017",value:2},{label:"2018",value:3},{label:"2019",value:4}],warnTipList:[{label:"全部",value:-1},{label:"具有报警的项目",value:0}],signAndFinishList:[{label:"全部",value:-1},{label:"未签约先放号",value:0},{label:"签约后长期无工程信息",value:1},{label:"已完工但未竣工",value:2}],fileConditionnList:[{label:"全部",value:-1},{label:"档案全部交齐",value:0},{label:"归档未完成",value:1}],classConditionList:[{label:"全部",value:-1},{label:"精品项目",value:0},{label:"一般项目",value:1},{label:"难收尾项目",value:2}],receivablesContionList:[{label:"全部",value:-1},{label:"收款全部完成",value:0},{label:"未收预收款",value:1}],performBondList:[{label:"全部",value:-1},{label:"具有履约保证金的项目",value:0}],qualityBondList:[{label:"全部",value:-1},{label:"具有质量保证金的项目",value:0}],shipmentRateList:[],inQualityList:[{label:"全部",value:-1},{label:"无质保的项目",value:0},{label:"有质保的项目",value:1}],subItemsList:[{label:"全部",value:-1},{label:"具有分包的项目",value:0}],sortList:["按签约价","按结算价","按毛利率","按总进度","按出货率","按收款率","按商务人","按项目经理"]}},created:function(){var e=this;setTimeout(function(){var t=document.documentElement.clientHeight;document.getElementById("FilterBlock").style.height=t+"px",e.tableHieght=t},0),this.getList()},computed:x()({},Object(l.c)({resultDataOrigin:function(e){return e.resultDataOrigin}})),methods:x()({},Object(l.b)(["updateContractNo","updateResultData"]),{goDetail:function(e){this.updateContractNo(e["合同号"]),this.$router.push({name:"InfoDynamicTable"})},getList:function(){var e=this,t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<JA_LIST xmlns="http://tempuri.org/">',t+="<FSQL>select FContractNo 合同号,b.fname 项目名称,b.FNumber 项目编号 from t_RPContract a left join t_Item_3001 b on a.fbase=b.FItemID order by FContractNo</FSQL>",t+="</JA_LIST>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("JA_LIST",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("JA_LISTResponse")[0].getElementsByTagName("JA_LISTResult")[0],l=y()(s).html();e.updateResultData(JSON.parse(l))}).catch(function(e){console.log(e)})},enterEvent:function(){13===(event.keyCode?event.keyCode:event.which?event.which:event.charCode)&&this.mohuSearch()},mohuSearch:function(){if(this.formFilter.vagueSearch){this.loading=!0;var e=[],t="";this.formFilter.vagueSearch.trim().split("*").map(function(e){t=t+".*"+e});var a=new RegExp(t);this.resultDataOrigin.map(function(t,s){a.test(t["合同号"])&&e.push(t)}),this.resultData=e,this.loading=!1}else this.resultData=[]}})},k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"FilterTable"},[a("el-row",[a("el-col",{staticClass:"FilterBlock",attrs:{span:11,id:"FilterBlock"}},[a("section",[a("el-row",[a("el-form",{ref:"formFilter",attrs:{model:e.formFilter,"label-width":"70px","label-position":"left",size:"mini"}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"签约部门"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.signDepartment,callback:function(t){e.$set(e.formFilter,"signDepartment",t)},expression:"formFilter.signDepartment"}},e._l(e.signDepartmentList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"合同金额"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.contractPrice,callback:function(t){e.$set(e.formFilter,"contractPrice",t)},expression:"formFilter.contractPrice"}},e._l(e.contractPriceList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"签约年份"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.signYear,callback:function(t){e.$set(e.formFilter,"signYear",t)},expression:"formFilter.signYear"}},e._l(e.signYearList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"报警与提示","label-width":"90px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.warnTip,callback:function(t){e.$set(e.formFilter,"warnTip",t)},expression:"formFilter.warnTip"}},e._l(e.warnTipList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"签约与竣工","label-width":"90px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.signAndFinish,callback:function(t){e.$set(e.formFilter,"signAndFinish",t)},expression:"formFilter.signAndFinish"}},e._l(e.signAndFinishList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"归档情况"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.fileConditionn,callback:function(t){e.$set(e.formFilter,"fileConditionn",t)},expression:"formFilter.fileConditionn"}},e._l(e.fileConditionnList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"分类管控"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.classCondition,callback:function(t){e.$set(e.formFilter,"classCondition",t)},expression:"formFilter.classCondition"}},e._l(e.classConditionList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:24}},[a("el-row",[a("el-col",{staticClass:"TextAlignL",attrs:{span:15}},[a("el-form-item",{attrs:{label:"收款情况"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.receivablesContion,callback:function(t){e.$set(e.formFilter,"receivablesContion",t)},expression:"formFilter.receivablesContion"}},e._l(e.receivablesContionList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"履约保证金","label-width":"90px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.performBond,callback:function(t){e.$set(e.formFilter,"performBond",t)},expression:"formFilter.performBond"}},e._l(e.performBondList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"质量保证金","label-width":"90px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.qualityBond,callback:function(t){e.$set(e.formFilter,"qualityBond",t)},expression:"formFilter.qualityBond"}},e._l(e.qualityBondList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"出货率(大于输入数的)","label-width":"150px"}},[a("el-input",{model:{value:e.formFilter.shipmentRate,callback:function(t){e.$set(e.formFilter,"shipmentRate",t)},expression:"formFilter.shipmentRate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"收款率(小于输入数的)","label-width":"150px"}},[a("el-input",{model:{value:e.formFilter.receivablesRate,callback:function(t){e.$set(e.formFilter,"receivablesRate",t)},expression:"formFilter.receivablesRate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"进入质保期项目","label-width":"110px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.inQuality,callback:function(t){e.$set(e.formFilter,"inQuality",t)},expression:"formFilter.inQuality"}},e._l(e.inQualityList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分包项目情况","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formFilter.subItems,callback:function(t){e.$set(e.formFilter,"subItems",t)},expression:"formFilter.subItems"}},e._l(e.subItemsList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8,offset:1}},[a("section",[a("p",{staticStyle:{"text-align":"left"}},[e._v("排序")]),e._v(" "),a("div",{staticClass:"sortBlock"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"按签约价"}},e._l(e.sortList,function(t,s){return a("el-menu-item",{key:s,attrs:{index:t}},[a("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t))])])}),1)],1)]),e._v(" "),a("section",[a("p",{staticStyle:{"text-align":"left","padding-top":"5px"}},[e._v("模糊查询")]),e._v(" "),a("div",{staticClass:"vagueSearchBlock"},[a("el-input",{staticClass:"MarginT_10",attrs:{clearable:"",size:"mini"},on:{blur:e.mohuSearch},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enterEvent(t)}},model:{value:e.formFilter.vagueSearch,callback:function(t){e.$set(e.formFilter,"vagueSearch",t)},expression:"formFilter.vagueSearch"}}),e._v(" "),a("P",{staticStyle:{"font-size":"12px","margin-top":"5px",padding:"0 5px"}},[e._v("可以中间夹带*来查询，*代表任意字符")])],1)])])],1)],1)],1)],1)],1)]),e._v(" "),a("el-col",{staticClass:"ResultBlock BgGray",attrs:{span:13,id:"ResultBlock"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"resultTable",data:e.resultData,height:e.tableHieght,border:""},on:{"row-dblclick":e.goDetail}},[a("el-table-column",{attrs:{fixed:"",type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"合同号",label:"合同号","show-overflow-tooltip":"",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"项目名称",label:"项目名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"项目编号",label:"项目编号","show-overflow-tooltip":""}})],1)],1)],1)],1)},staticRenderFns:[]};var T=a("C7Lr")(B,k,!1,function(e){a("twrf")},"data-v-cae852f6",null).exports,I={name:"Contract",data:function(){return{formContract:{constructionTeam:"",department:"",payTerm:"",salesman:"",contractDate:"",contractName:"",contractNo:"",productionCode:"",affiliatedCompany:"",productionProgress:""},formAdd:{list:[{pcode:"CODE1",pname:"产品名称1",pmodel:"规格型号1",pamount:"",pprice:"",psum:"",pnote:"",punit:"件"}]},productionCodeList:[{value:"CODE1",label:"CODE1"},{value:"CODE2",label:"CODE2"}],productionNumber:[{value:"项目编号1",label:"项目编号1"},{value:"项目编号2",label:"项目编号2"}],constructionTeamList:[{value:"施工1队",label:"施工1队"}],payTermList:[{value:"付款条件1",label:"付款条件1"}],departmentList:[{value:"市场部",label:"市场部"}],salesmanList:[{value:"张三",label:"张三"}],companyeList:[{value:"上海旺策尔信息科技有限公司",label:"上海旺策尔信息科技有限公司"}],progressList:[{value:"完工",label:"完工"}]}},computed:{},created:function(){},methods:{addLine:function(){this.formAdd.list.push({pcode:"",pname:"",pmodel:"",pamount:"",pprice:"",psum:"",pnote:"",punit:""})},changePCode:function(e){console.log(e)}}},E={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Contract"},[a("h2",{staticClass:"MarginT_20 MarginB_20"},[e._v("合同（应收）")]),e._v(" "),a("el-row",{staticClass:"MarginT_20"},[a("el-form",{ref:"formContract",staticStyle:{"padding-right":"20px"},attrs:{model:e.formContract,"label-width":"90px",size:"small"}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"合同日期"}},[a("el-date-picker",{attrs:{prop:"contractDate",type:"date",placeholder:"选择日期"},model:{value:e.formContract.contractDate,callback:function(t){e.$set(e.formContract,"contractDate",t)},expression:"formContract.contractDate"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"合同名称",prop:"contractName"}},[a("el-input",{attrs:{clearable:""},model:{value:e.formContract.contractName,callback:function(t){e.$set(e.formContract,"contractName",t)},expression:"formContract.contractName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"合同号",prop:"contractNo"}},[a("el-input",{attrs:{clearable:""},model:{value:e.formContract.contractNo,callback:function(t){e.$set(e.formContract,"contractNo",t)},expression:"formContract.contractNo"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"施工队",prop:"constructionTeam"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:e.formContract.constructionTeam,callback:function(t){e.$set(e.formContract,"constructionTeam",t)},expression:"formContract.constructionTeam"}},e._l(e.constructionTeamList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"付款条件",prop:"payTerm"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formContract.payTerm,callback:function(t){e.$set(e.formContract,"payTerm",t)},expression:"formContract.payTerm"}},e._l(e.payTermList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"部门",prop:"department"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formContract.department,callback:function(t){e.$set(e.formContract,"department",t)},expression:"formContract.department"}},e._l(e.departmentList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"业务员",prop:"salesman"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formContract.salesman,callback:function(t){e.$set(e.formContract,"salesman",t)},expression:"formContract.salesman"}},e._l(e.salesmanList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"项目编号",prop:"productionCode"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:e.formContract.productionCode,callback:function(t){e.$set(e.formContract,"productionCode",t)},expression:"formContract.productionCode"}},e._l(e.productionNumber,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"所属公司",prop:"affiliatedCompany"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formContract.affiliatedCompany,callback:function(t){e.$set(e.formContract,"affiliatedCompany",t)},expression:"formContract.affiliatedCompany"}},e._l(e.companyeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"项目进度",prop:"productionProgress"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formContract.productionProgress,callback:function(t){e.$set(e.formContract,"productionProgress",t)},expression:"formContract.productionProgress"}},e._l(e.progressList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"listColumnTit"},[a("el-col",{attrs:{span:1}},[a("span",[e._v("行号")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v("产品代码")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v("产品名称")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v("规格型号")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("span",[e._v("数量")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v("含税单价")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v("价税合计")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v("备注")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v("计量单位")])])],1),e._v(" "),e._l(e.formAdd.list,function(t,s){return a("el-row",{key:s,staticClass:"listTable"},[a("el-col",{staticStyle:{background:"lightsteelblue"},attrs:{span:1}},[a("span",[e._v(e._s(s+1))])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-select",{staticStyle:{width:"95%",margin:"0 auto"},attrs:{filterable:"",size:"mini",placeholder:"请选择"},on:{change:e.changePCode},model:{value:t.pcode,callback:function(a){e.$set(t,"pcode",a)},expression:"Record.pcode"}},e._l(e.productionCodeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v(e._s(t.pname))])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v(e._s(t.pmodel))])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("el-input",{staticStyle:{width:"95%",margin:"0 auto"},attrs:{size:"mini",clearable:""},model:{value:t.pamount,callback:function(a){e.$set(t,"pamount",a)},expression:"Record.pamount"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-input",{staticStyle:{width:"95%",margin:"0 auto"},attrs:{size:"mini",clearable:""},model:{value:t.pprice,callback:function(a){e.$set(t,"pprice",a)},expression:"Record.pprice"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-input",{staticStyle:{width:"95%",margin:"0 auto"},attrs:{size:"mini",clearable:""},model:{value:t.psum,callback:function(a){e.$set(t,"psum",a)},expression:"Record.psum"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("el-input",{staticStyle:{width:"95%",margin:"0 auto"},attrs:{size:"mini",clearable:""},model:{value:t.pnote,callback:function(a){e.$set(t,"pnote",a)},expression:"Record.pnote"}})],1),e._v(" "),a("el-col",{attrs:{span:3}},[a("span",[e._v(e._s(t.punit))])])],1)}),e._v(" "),a("section",{staticClass:"MarginT_20"},[a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addLine}},[e._v("新增一行")])],1)],2)},staticRenderFns:[]};var D=a("C7Lr")(I,E,!1,function(e){a("VdfU")},"data-v-7a09a63e",null).exports,j=(a("HzJ8"),a("hRKE"),a("ZLEe"),a("MgeX"),a("mgIi")),P=a.n(j);function $(e,t,a){var s=new Date;s.setTime(s.getTime()+60*a*60*1e3);var l="expires="+s.toUTCString();document.cookie=e+"="+t+"; "+l}function A(){return window.localStorage&&(window.localStorage.setItem("a",123),123===window.localStorage.getItem("a"))}function M(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?unescape(t[2]):null}var R={local:{set:function(e,t){if(A())window.localStorage.setItem(e,t);else{var a=new Date;a.setTime(a.getTime()+2592e6),document.cookie=e+"="+escape(t)+";expires="+a.toGMTString()}},get:function(e){return A()?window.localStorage.getItem(e)?window.localStorage.getItem(e):null:M(e)},clear:function(e){if(A())window.localStorage.removeItem(e);else{var t=new Date;t.setTime(t.getTime()-1);var a=M(e);null!=a&&(document.cookie=e+"="+a+";expires="+t.toGMTString())}}}},J={name:"Login",data:function(){return{btLoading:!1,realCode:"",Form:{accountName:"",accountPsd:""},rules:{accountName:[{validator:function(e,t,a){""===t?a(new Error("请输入用户名")):a()},trigger:"change"}],accountPsd:[{validator:function(e,t,a){""===t?a(new Error("请输入密码")):a()},trigger:"change"}]}}},computed:{},created:function(){},methods:x()({},Object(l.b)(["updateUserInfo"]),{Login:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.$message({message:"请将信息填写完整!",type:"warning"}),!1;t.sureLogin()})},sureLogin:function(){var e=this;this.btLoading=!0;var t='<?xml version="1.0" encoding="utf-8"?>';t+='<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> ',t+="<soap:Body> ",t+='<ja_login xmlns="http://tempuri.org/">',t+="<fuserno>"+this.Form.accountName+"</fuserno>",t+="<fuserpsw>"+this.Form.accountPsd+"</fuserpsw>",t+="</ja_login>",t+="</soap:Body>",t+="</soap:Envelope>",this.Http.post("ja_login",t).then(function(t){var a=t.data,s=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("ja_loginResponse")[0].getElementsByTagName("ja_loginResult")[0],l=y()(s).html(),o=JSON.parse(l);switch(o.status){case"1":$("ZT_14a808c40bba58c2c",P.a.HmacSHA256((e.Form.accountName+e.Form.accountPsd).toString(),"14a808c40bba58c2c"),6),e.updateUserInfo({fempid:o.fempid}),e.$router.push({name:"FilterTable"}),e.btLoading=!1;break;default:e.$message({message:o.message+"!",type:"error"}),e.btLoading=!1}}).catch(function(t){console.log(t),e.btLoading=!1})}})},O={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrap"},[a("div",{staticClass:"Login"},[e._m(0),e._v(" "),a("el-form",{ref:"Form",staticClass:"demo-ruleForm",attrs:{model:e.Form,rules:e.rules,"label-width":"0px"}},[a("el-form-item",{attrs:{label:"",prop:"accountName"}},[a("el-input",{attrs:{placeholder:"用户名",clearable:""},model:{value:e.Form.accountName,callback:function(t){e.$set(e.Form,"accountName",t)},expression:"Form.accountName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"",prop:"accountPsd"}},[a("el-input",{attrs:{type:"password",placeholder:"密码",clearable:""},model:{value:e.Form.accountPsd,callback:function(t){e.$set(e.Form,"accountPsd",t)},expression:"Form.accountPsd"}})],1),e._v(" "),a("el-button",{staticClass:"bt",attrs:{type:"primary",loading:e.btLoading},on:{click:function(t){return e.Login("Form")}}},[e._v("登陆")])],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"MarginB_20"},[t("h2",{staticClass:"ColorWhite",staticStyle:{"letter-spacing":".34em"}},[this._v("用户登陆")])])}]};var q=a("C7Lr")(J,O,!1,function(e){a("4Nbu")},"data-v-3cf23c11",null).exports;s.default.use(m.a);var H=new m.a({routes:[{path:"/Login",name:"Login",component:q,meta:{requireAuth:!1}},{path:"/InfoDynamicTable",name:"InfoDynamicTable",component:N,meta:{requireAuth:!0}},{path:"/FilterTable",name:"FilterTable",component:T,meta:{requireAuth:!0}},{path:"/Contract",name:"Contract",component:D,meta:{requireAuth:!0}},{path:"*",redirect:"/Login"}]});H.beforeEach(function(e,t,a){n.dispatch("changePath",e.name),e.meta.requireAuth&&!function(e){for(var t=e+"=",a=document.cookie.split(";"),s=0;s<a.length;s++){for(var l=a[s];" "===l.charAt(0);)l=l.substring(1);if(-1!==l.indexOf(t))return l.substring(t.length,l.length)}return""}("ZT_14a808c40bba58c2c")?(localStorage.clear(),a({path:"/Login"})):a(),n.dispatch("changePath",e.name)});var U=H,X=a("cHER"),z=a.n(X),Q=(a("SO90"),a("84iU")),G=a.n(Q),Y="http://192.168.1.9:8090/Service1.asmx",V=G.a.CancelToken.source();function Z(e,t,a){var s=Date.now();return R.local.get("token")&&(G.a.defaults.headers.common.token=R.getLocal("token")),new u.a(function(l,o){G()({method:e,url:""+Y,crossDomain:!0,headers:{"content-Type":"text/xml; charset=utf-8",SOAPAction:"http://tempuri.org/"+t,"X-Timestamp":s},cancelToken:V.token,data:a}).then(function(e){l(e)}).catch(function(e){o(e.message)})})}G.a.interceptors.request.use(function(e){return e}),G.a.interceptors.response.use(function(e){return e},function(e){if(e.response){var t=e.response.data;switch(n.dispatch("toggleLoadingBt",!1),e.response.status){case 403:X.Message.error({message:"拒绝访问!"});break;case 500:"Token失效，请重新登录"===t.message&&X.Message.error({message:"很抱歉，登录已过期，请重新登录!"});break;case 404:X.Message.error({message:"很抱歉，资源未找到!"});break;case 504:X.Message.error({message:"网络超时!"});break;case 401:X.Message.error({message:"未授权，请重新登录!"});break;default:X.Message.error({message:t.message+"!"})}}return u.a.reject(e)});var W={post:function(e,t){return Z("post",e,t)}};a("WEav");s.default.config.productionTip=!1,s.default.prototype.Http=W,s.default.use(z.a),s.default.use(l.a),new s.default({el:"#app",store:n,router:U,components:{App:c},template:"<App/>"})},SO90:function(e,t){},VdfU:function(e,t){},WEav:function(e,t){},akVs:function(e,t){},alRU:function(e,t){},nUBg:function(e,t){},twrf:function(e,t){}},[0]);
//# sourceMappingURL=app.4096fbf45ec6fd50c83b.js.map